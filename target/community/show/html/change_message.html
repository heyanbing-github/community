<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>后台模板</title>
		<link rel="stylesheet" href="../assets/css/amazeui.css" />
		<link rel="stylesheet" href="https://www.jq22.com/jquery/font-awesome.4.6.0.css">
		<link rel="stylesheet" href="../assets/css/core.css" />
		<link rel="stylesheet" href="../assets/css/menu.css" />
		
		<link rel="stylesheet" href="../assets/css/admin.css" />
		<link rel="stylesheet" href="../assets/css/page/typography.css" />
		<link rel="stylesheet" href="../assets/css/page/form.css" />
		<script src="/community/jq/jquery-1.11.2.js"></script>
	</head>
	<body>
		<!-- Begin page -->
		<header class="am-topbar am-topbar-fixed-top">		
			<div class="am-topbar-left am-hide-sm-only">
                <a href="index.html" class="logo"><span>Admin<span>to</span></span><i class="zmdi zmdi-layers"></i></a>
            </div>
	
			<div class="contain">
				<ul class="am-nav am-navbar-nav am-navbar-left">

					<li><h4 class="page-title">修改信息</h4></li>
				</ul>
				
				<ul class="am-nav am-navbar-nav am-navbar-right">
					<li class="inform"><i class="am-icon-bell-o" aria-hidden="true"></i></li>
					<li class="hidden-xs am-hide-sm-only">
                        <form role="search" class="app-search">
                            <input type="text" placeholder="Search..." class="form-control">
                            <a href=""><img src="../assets/img/search.png"></a>
                        </form>
                    </li>
				</ul>
			</div>
		</header>
		<!-- end page -->
		
		
		<div class="admin">
			<!--<div class="am-g">-->
		<!-- ========== Left Sidebar Start ========== -->
		<!--<div class="left side-menu am-hide-sm-only am-u-md-1 am-padding-0">
			<div class="slimScrollDiv" style="position: relative; overflow: hidden; width: auto; height: 548px;">
				<div class="sidebar-inner slimscrollleft" style="overflow: hidden; width: auto; height: 548px;">-->
                  <!-- sidebar start -->
				  <div class="admin-sidebar am-offcanvas  am-padding-0" id="admin-offcanvas">
				    <div class="am-offcanvas-bar admin-offcanvas-bar">
				    	<!-- User -->
						<div class="user-box am-hide-sm-only">
	                        <div class="user-img">
	                            <img src="../assets/img/avatar-1.jpg" alt="user-img" title="Mat Helme" class="img-circle img-thumbnail img-responsive">
	                            <div class="user-status offline"><i class="am-icon-dot-circle-o" aria-hidden="true"></i></div>
	                        </div>
							<h5><a href="/community/show/font/main.html">返回主页</a> </h5>
	                        <ul class="list-inline">
	                            <li>
	                                <a href="#">
	                                    <i class="am-icon-cog" aria-hidden="true"></i>
	                                </a>
	                            </li>
	
	                            <li>
	                                <a href="#" class="text-custom">
	                                    <i class="am-icon-cog" aria-hidden="true"></i>
	                                </a>
	                            </li>
	                        </ul>
	                    </div>
	                    <!-- End User -->
	            
						 <ul class="am-list admin-sidebar-list">
						    <li><a href="../index.html"><span class="am-icon-home"></span> 首页</a></li>
						    <li class="admin-parent">
						      <a class="am-cf" data-am-collapse="{target: '#collapse-nav1'}"><span class="am-icon-table"></span> 用户 <span class="am-icon-angle-right am-fr am-margin-right"></span></a>
						      <ul class="am-list am-collapse admin-sidebar-sub am-in" id="collapse-nav1">
						        <li><a href="../html/userInfo.html" class="am-cf"> 个人信息</span></a></li>
						        <li><a href="../html/managerText.html">管理帖子</a></li>
						 								<li><a href="../html/managerFile.html">管理文件</a></li>
						 								<li><a href="../html/buyGoods.html">购买的商品</a></li>
						      </ul>
						    </li>
						    <li class="admin-parent">
						      <a class="am-cf" data-am-collapse="{target: '#collapse-nav2'}"><i class="am-icon-line-chart" aria-hidden="true"></i> 管理员 <span class="am-icon-angle-right am-fr am-margin-right"></span></a>
						      <ul class="am-list am-collapse admin-sidebar-sub am-in" id="collapse-nav2">
						        <li><a href="../html/adminInfo.html" class="am-cf"> 个人信息</span></a></li>
						        <li><a href="../html/adminManagerUser.html" class="am-cf">用户管理</span></a></li>
						        <li><a href="../html/adminManagerGoods.html" class="am-cf"> 商品管理</span></a></li>
						 								<li><a href="../html/waitCheck.html" class="am-cf"> 待审核通知</span></a></li>
						 								<li><a href="../html/doNotice.html" class="am-cf"> 发布公告</span></a></li>
						      </ul>
						    </li>
						    <li class="admin-parent">
						      <a class="am-cf" data-am-collapse="{target: '#collapse-nav5'}"><span class="am-icon-file"></span> 系统信息 <span class="am-icon-angle-right am-fr am-margin-right"></span></a>
						      <ul class="am-list am-collapse admin-sidebar-sub am-in" id="collapse-nav5">
						        <li><a href="../html/userSpread.html">用户分布</a></li>
						 								<li><a href="../html/versionNnumber.html">版本号</a></li>
						 								<li><a href="../html/versionNnumber.html">开发团队介绍</a></li>
						      </ul>
						    </li>
						  </ul>
				</div>
				  </div>

		


			
			<!-- row start -->
			<div class="am-g">
				<!-- col start -->
				<div class="am-u-md-6">
					<div class="card-box" style="margin-left:200px;width: 900px; height: 710px;">
						<h></h><br/>
						<h4 class="header-title m-t-0 m-b-30">修改个人信息</h4>
						<form class="am-form" action="/community/user/updateUserInfo" method="post" enctype="multipart/form-data">
							<div>
								<br>
								<span id="uphoto"></span>
								<label >修改头像</label>
								<input type="file" name="uphoto">
							</div>
							<div class="am-form-group">
								<br>
								<span></span>
								<label>修改昵称</label>
								<input type="text" class="am-radius" name="nickName" onblur="checkNickName()">
							</div>
							<div >
								<br>
								<label>修改地址</label>
								<input type="text" class="am-radius" name="address">
							</div>
							<div >
								<br>
								<label>修改邮箱</label>
								<input type="email" class="am-radius" name="email">
							</div>
							<div >
								<br>
								<label>修改电话</label>
								<input type="text" class="am-radius" name="phone">
							</div>
							<br>
						    <button type="submit" class="am-btn am-btn-primary" >确认修改</button>
						</form>
					</div>
				</div>
			</div>
			</div>
		</div>
		</div>
		</div>
		


		<script type="text/javascript" src="../assets/js/amazeui.min.js"></script>
		<script type="text/javascript" src="../assets/js/app.js" ></script>
		<script type="text/javascript" src="../assets/js/blockUI.js" ></script>

	</body>
	<script>
		function checkNickName() {
			//昵称不能为空
			var nickName =$("input[name='nickName']").val();
			var span = $("input[id='nickName']").prev();
			//判断昵称是否符合规范
			var regx = /^[\u4E00-\u9FA5A-Za-z0-9]{1,7}$/;
			if(!regx.test(nickName)){
				span.css("color","red");
				span.text("用户名不符合规范");
				return;
			}
			$.get("/community/user/checkNickName",{"nickName":nickName},function (data) {
				// data = JSON.parse(data);
				if (data.state == 0){
					span.css("color","green");
					span.text("√可用");
				}else {
					span.css("color","red");
					span.text("昵称已存在");
				}
			})
		}
		function checkPhone() {
			//手机号不能为空
			var phone =$("input[id='phone']").val();
			var span = $("input[id='phone']").prev();
			//判断昵称是否符合规范
			var regx = /^[0-9]{11}$/;
			if(!regx.test(phone)){
				span.css("color","red");
				span.text("手机号不符合规范");
				return;
			}
			//判断号码是否被注册
			$.get("/community/user/checkPhone",{"phone":phone},function (data) {
				//data = JSON.parse(data);
				if (data.state == 0){
					span.css("color","green");
					span.text("√可用");
				}else{
					span.css("color","red");
					span.text("号码已被使用");
				}
			})
		}
		//密码不能为空
		function checkPassword() {
			//密码不能为空
			var password =$("input[id='password']").val();
			var span = $("input[id='password']").prev();
			//判断昵称是否符合规范
			var regx = /^[_a-zA-Z0-9]{6,16}$/;
			if(!regx.test(password)){
				span.css("color","red");
				span.text("密码不符合规范");
				return;
			}else if(password.length<14){
				span.css("color","green");
				span.text("密码安全系数低，建议修改");
				return;
			}else{
				span.css("color","green");
				span.text("√可用");
			}
		}
		//邮箱是否符合规范
		function checkEmail() {
			//邮箱不能为空
			var email =$("input[id='email']").val();
			var span = $("input[id='email']").prev();
			//判断邮箱是否符合规范
			var regx = /^[A-Za-z0-9]+([_\.][A-Za-z0-9]+)*@([A-Za-z0-9\-]+\.)+[A-Za-z]{2,6}$/;///^[A-Za-z0-9]+([_\.][A-Za-z0-9]+)*@([A-Za-z0-9\-]+\.)+[A-Za-z]{2,6}$/;
			if(!regx.test(email)){
				span.css("color","red");
				span.text("邮箱不符合规范");
				return;
			}
			$.get("/community/user/checkEmail",{"email":email},function (data) {
				//data = JSON.parse(data);
				if (data.state == 0){
					span.text("√可用");
					span.css("color","green");
				}else {
					span.css("color","red");
					span.text("邮箱已被注册");
				}
			})
		}

		/**
		 * 点击提交事件
		 */
		// $("button[type='submit']").click(function (){
		// 	$.post("/community/user/changeMessage",$(".am-form").serialize(),function(data){
		// 		//data = JSON.parse(data);
		// 		if(data.state == 0){//注册成功
		// 			window.location.href = "/community/show/html/userInfo.html";
		// 		}else{
		// 			confirm("修改失败");
		// 		}
		// 	})
		// });

		$.get("/community/user/getLoginUser", {}, function (result) {
			var span = $("#uphoto");
			var img = $("<img />");
			img.css({"height":"100px", "width":"100px","border-radius":"50%"});
			span.append(img);
			img.attr("src","/images/" +result.data.user.uphoto);

			var nickname = $("input[name='nickName']");
			nickname.val(result.data.user.nickName);

			var address = $("input[name='address']");
			address.val(result.data.user.address);

			var email = $("input[name='email']");
			email.val(result.data.user.email);

			var phone = $("input[name='phone']");
			phone.val(result.data.user.phone);
		})
	</script>
</html>
